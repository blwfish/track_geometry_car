; PlatformIO Project Configuration File
;
; Track Geometry Car
; ESP32-WROOM + MPU-6050 IMU + SSD1315 OLED + WiFi AP + WebSocket

[platformio]
default_envs = esp32dev

[env:esp32dev]
platform = espressif32
board = esp32dev
framework = arduino

; Serial monitor
monitor_speed = 115200

; Library dependencies
lib_deps =
    olikraus/U8g2@^2.35.0
    me-no-dev/ESPAsyncWebServer@^1.2.4
    me-no-dev/AsyncTCP@^1.1.1

; Filesystem (LittleFS uses the default SPIFFS partition)
board_build.filesystem = littlefs

; Extra scripts for build versioning
extra_scripts = pre:version_build.py

; Build flags
build_flags =
    -DCORE_DEBUG_LEVEL=0
    -DBOARD_HAS_PSRAM=0
    ; BUILD_GIT_HASH and BUILD_TIME are injected by version_build.py

; Upload settings
upload_speed = 921600

; ===== Native test environment (runs on host, no ESP32 needed) =====
[env:native]
platform = native
test_framework = unity

; Don't compile project src â€” test files #include the .cpp directly
; to avoid hardware-dependent modules pulling in Wire.h etc.
build_src_filter = -<*>

; Mock Arduino.h: put mock dir first on include path so it shadows
; the real Arduino.h. Also include the project headers.
build_flags =
    -I test/mock
    -I include
